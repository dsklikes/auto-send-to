syntax = "proto3";

package devvit.gateway.v1alpha;

import "devvit/data/triggers/v1alpha/triggers.proto";
import "devvit/dev_portal/installation/installation.proto";
import "google/protobuf/empty.proto";

option go_package = "github.snooguts.net/reddit/reddit-devplatform-monorepo/devvit-gateway-service/generated/protos/devvit/gateway";

service Triggers {
  rpc OnTrigger(devvit.data.triggers.v1alpha.TriggerEvent) returns (TriggerResponse);
  rpc OnInstall(devvit.dev_portal.installation.InstallationInfo) returns (google.protobuf.Empty);
  rpc OnUninstall(devvit.dev_portal.installation.InstallationInfo) returns (google.protobuf.Empty);
  rpc OnInstallChanged(devvit.dev_portal.installation.InstallationInfo) returns (google.protobuf.Empty);
}

message TriggerResponse {
  // total number of apps invoked
  int32 total = 1;
  // successful installation ids
  repeated string success = 2;
  // map of installation ids to error message
  map<string, string> errors = 3;
}
